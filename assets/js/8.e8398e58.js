(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{171:function(s,t,a){"use strict";a.r(t);var n=a(0),e=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"dns-域名服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-域名服务器","aria-hidden":"true"}},[s._v("#")]),s._v(" dns 域名服务器")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[s._v("const")]),s._v(" dns "),a("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" module"),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token function"}},[s._v("require")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token string"}},[s._v("'dns'")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nconsole"),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token function"}},[s._v("log")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dns"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" lookup: "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Function: lookup"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  lookupService: "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Function: lookupService"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  Resolver: "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Function: Resolver"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  setServers: "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Function: defaultResolverSetServers"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  ADDRCONFIG: 1024,\n  V4MAPPED: 2048,\n  NODATA: "),a("span",{attrs:{class:"token string"}},[s._v("'ENODATA'")]),s._v(",\n  FORMERR: "),a("span",{attrs:{class:"token string"}},[s._v("'EFORMERR'")]),s._v(",\n  SERVFAIL: "),a("span",{attrs:{class:"token string"}},[s._v("'ESERVFAIL'")]),s._v(",\n  NOTFOUND: "),a("span",{attrs:{class:"token string"}},[s._v("'ENOTFOUND'")]),s._v(",\n  NOTIMP: "),a("span",{attrs:{class:"token string"}},[s._v("'ENOTIMP'")]),s._v(",\n  REFUSED: "),a("span",{attrs:{class:"token string"}},[s._v("'EREFUSED'")]),s._v(",\n  BADQUERY: "),a("span",{attrs:{class:"token string"}},[s._v("'EBADQUERY'")]),s._v(",\n  BADNAME: "),a("span",{attrs:{class:"token string"}},[s._v("'EBADNAME'")]),s._v(",\n  BADFAMILY: "),a("span",{attrs:{class:"token string"}},[s._v("'EBADFAMILY'")]),s._v(",\n  BADRESP: "),a("span",{attrs:{class:"token string"}},[s._v("'EBADRESP'")]),s._v(",\n  CONNREFUSED: "),a("span",{attrs:{class:"token string"}},[s._v("'ECONNREFUSED'")]),s._v(",\n  TIMEOUT: "),a("span",{attrs:{class:"token string"}},[s._v("'ETIMEOUT'")]),s._v(",\n  EOF: "),a("span",{attrs:{class:"token string"}},[s._v("'EOF'")]),s._v(",\n  FILE: "),a("span",{attrs:{class:"token string"}},[s._v("'EFILE'")]),s._v(",\n  NOMEM: "),a("span",{attrs:{class:"token string"}},[s._v("'ENOMEM'")]),s._v(",\n  DESTRUCTION: "),a("span",{attrs:{class:"token string"}},[s._v("'EDESTRUCTION'")]),s._v(",\n  BADSTR: "),a("span",{attrs:{class:"token string"}},[s._v("'EBADSTR'")]),s._v(",\n  BADFLAGS: "),a("span",{attrs:{class:"token string"}},[s._v("'EBADFLAGS'")]),s._v(",\n  NONAME: "),a("span",{attrs:{class:"token string"}},[s._v("'ENONAME'")]),s._v(",\n  BADHINTS: "),a("span",{attrs:{class:"token string"}},[s._v("'EBADHINTS'")]),s._v(",\n  NOTINITIALIZED: "),a("span",{attrs:{class:"token string"}},[s._v("'ENOTINITIALIZED'")]),s._v(",\n  LOADIPHLPAPI: "),a("span",{attrs:{class:"token string"}},[s._v("'ELOADIPHLPAPI'")]),s._v(",\n  ADDRGETNETWORKPARAMS: "),a("span",{attrs:{class:"token string"}},[s._v("'EADDRGETNETWORKPARAMS'")]),s._v(",\n  CANCELLED: "),a("span",{attrs:{class:"token string"}},[s._v("'ECANCELLED'")]),s._v(",\n  getServers: "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Function: bound getServers"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  resolve: "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Function: bound resolve"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  resolveAny: "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Function: bound queryAny"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  resolve4: "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Function: bound queryA"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  resolve6: "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Function: bound queryAaaa"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  resolveCname: "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Function: bound queryCname"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  resolveMx: "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Function: bound queryMx"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  resolveNs: "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Function: bound queryNs"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  resolveTxt: "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Function: bound queryTxt"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  resolveSrv: "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Function: bound querySrv"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  resolvePtr: "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Function: bound queryPtr"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  resolveNaptr: "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Function: bound queryNaptr"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  resolveSoa: "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Function: bound querySoa"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  reverse: "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Function: bound getHostByAddr"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("h2",{attrs:{id:"dns-模块两类函数："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-模块两类函数：","aria-hidden":"true"}},[s._v("#")]),s._v(" dns 模块两类函数：")]),s._v(" "),a("ol",[a("li",[s._v("第一类函数，使用底层操作系统工具进行域名解析，且无需进行网络通信。 这类函数只有一个：dns.lookup()。")])]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[s._v("const")]),s._v(" dns "),a("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("require")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token string"}},[s._v("'dns'")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\ndns"),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token function"}},[s._v("lookup")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token string"}},[s._v("'zbj.com'")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" address"),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" family"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  console"),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token function"}},[s._v("log")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token string"}},[s._v("'IP 地址: %j 地址族: IPv%s'")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" address"),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" family"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{attrs:{class:"token comment"}},[s._v('// IP 地址: "192.0.43.8" 地址族: IPv4')]),s._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("第二类函数，连接到一个真实的 DNS 服务器进行域名解析，且始终使用网络进行 DNS 查询。 这类函数包含了 dns 模块中除 dns.lookup() 以外的所有函数。 这些函数使用与 dns.lookup() 不同的配置文件（例如 /etc/hosts）。 这类函数适合于那些不想使用底层操作系统工具进行域名解析、而是想使用网络进行 DNS 查询的开发者。")])]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[s._v("const")]),s._v(" dns "),a("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("require")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token string"}},[s._v("'dns'")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\ndns"),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token function"}},[s._v("resolve4")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token string"}},[s._v("'zbj.com'")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" addresses"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" err"),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  console"),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token function"}},[s._v("log")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token template-string"}},[a("span",{attrs:{class:"token string"}},[s._v("`IP 地址: ")]),a("span",{attrs:{class:"token interpolation"}},[a("span",{attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),a("span",{attrs:{class:"token constant"}},[s._v("JSON")]),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token function"}},[s._v("stringify")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("addresses"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),a("span",{attrs:{class:"token string"}},[s._v("`")])]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{attrs:{class:"token comment"}},[s._v('// IP 地址: ["49.4.65.160"]')]),s._v("\n  addresses"),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token function"}},[s._v("forEach")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("a"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    dns"),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token function"}},[s._v("reverse")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("a"),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" hostnames"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" err"),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),a("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      console"),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token function"}},[s._v("log")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token template-string"}},[a("span",{attrs:{class:"token string"}},[s._v("`IP 地址 ")]),a("span",{attrs:{class:"token interpolation"}},[a("span",{attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("a"),a("span",{attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),a("span",{attrs:{class:"token string"}},[s._v(" 逆向解析到域名: ")]),a("span",{attrs:{class:"token interpolation"}},[a("span",{attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),a("span",{attrs:{class:"token constant"}},[s._v("JSON")]),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token function"}},[s._v("stringify")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("hostnames"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),a("span",{attrs:{class:"token string"}},[s._v("`")])]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),a("span",{attrs:{class:"token comment"}},[s._v('// IP 地址 49.4.65.160 逆向解析到域名: ["ecs-49-4-65-160.compute.hwclouds-dns.com"]')]),s._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("h3",{attrs:{id:"两类函数的实现有什么区别？"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#两类函数的实现有什么区别？","aria-hidden":"true"}},[s._v("#")]),s._v(" 两类函数的实现有什么区别？")]),s._v(" "),a("p",[s._v("尽管 "),a("code",[s._v("dns.lookup()")]),s._v(" 和各种 "),a("code",[s._v("dns.resolve *()/ dns.reverse()")]),s._v(" 函数有相同的目标将网络的名字与网络地址联系在一起(反之亦然)，他们的行为是完全不同的。 这些差异可以有微妙但重大影响着 Node.js 程序行为。")]),s._v(" "),a("h4",{attrs:{id:"dns-lookup-与-直接使用-ping-命令类似（异步-同步）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-lookup-与-直接使用-ping-命令类似（异步-同步）","aria-hidden":"true"}},[s._v("#")]),s._v(" "),a("code",[s._v("dns.lookup()")]),s._v(" 与 直接使用 "),a("code",[s._v("ping")]),s._v(" 命令类似（异步 -> 同步）")]),s._v(" "),a("p",[s._v("在底层, "),a("code",[s._v("dns.lookup()")]),s._v(" 使用操作系统设施与大多数其他程序相同。"),a("code",[s._v("dns.lookup()")]),s._v(" 几乎总是解析给定的主机名与 "),a("code",[s._v("ping")]),s._v(" 命令一样.")]),s._v(" "),a("h4",{attrs:{id:"dns-resolve-dns-resolve-和-dns-reverse-通过网络执行dns查询（异步）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-resolve-dns-resolve-和-dns-reverse-通过网络执行dns查询（异步）","aria-hidden":"true"}},[s._v("#")]),s._v(" "),a("code",[s._v("dns.resolve()")]),s._v(", "),a("code",[s._v("dns.resolve*()")]),s._v(" 和 "),a("code",[s._v("dns.reverse()")]),s._v(" 通过网络执行DNS查询（异步）")]),s._v(" "),a("p",[s._v("这些功能实现与 "),a("code",[s._v("dns.lookup()")]),s._v(" 截然不同。它们不仅没有使用 "),a("code",[s._v("getaddrinfo(3)")]),s._v(" 并且通过网络执行DNS查询。使用异步网络通信，并且没有使用 "),a("code",[s._v("libuv")]),s._v(" 线程池。因此,这些函数不会像使用 "),a("code",[s._v("libuv")]),s._v(" 线程池的 "),a("code",[s._v("dns.lookup()")]),s._v(" 函数一样会对其它进程有负面影响。")]),s._v(" "),a("p",[s._v("它们不像 "),a("code",[s._v("dns.lookup()")]),s._v(" 一样使用相同的配置文件。例如，它们不会使用来自 "),a("code",[s._v("/etc/hosts")]),s._v(" 配置。")]),s._v(" "),a("h2",{attrs:{id:"dns-resolver-dns请求的独立解析程序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-resolver-dns请求的独立解析程序","aria-hidden":"true"}},[s._v("#")]),s._v(" dns.Resolver DNS请求的独立解析程序")]),s._v(" "),a("p",[s._v("使用默认的设置创建一个新的解析程序。为一个解析程序设置 "),a("code",[s._v("servers")]),s._v(" 使用 "),a("code",[s._v("resolver.setServers()")]),s._v("，它不会影响其他的解析程序：")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" Resolver "),a("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("require")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token string"}},[s._v("'dns'")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{attrs:{class:"token keyword"}},[s._v("const")]),s._v(" resolver "),a("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{attrs:{class:"token class-name"}},[s._v("Resolver")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nresolver"),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token function"}},[s._v("setServers")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{attrs:{class:"token string"}},[s._v("'4.4.4.4'")]),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{attrs:{class:"token comment"}},[s._v("// 这个请求将使用 ip: 4.4.4.4 上的服务，独立于全局设置")]),s._v("\nresolver"),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token function"}},[s._v("resolve4")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token string"}},[s._v("'zbj.com'")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" addresses"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" err"),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  console"),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token function"}},[s._v("log")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("addresses"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("h2",{attrs:{id:"resolver-cancel"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#resolver-cancel","aria-hidden":"true"}},[s._v("#")]),s._v(" resolver.cancel()")]),s._v(" "),a("p",[s._v("取消解析程序未解决的 DNS 查询，相应的回调用一个 "),a("code",[s._v("ECANCELLED")]),s._v(" 码调用。")]),s._v(" "),a("h2",{attrs:{id:"dns-getservers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-getservers","aria-hidden":"true"}},[s._v("#")]),s._v(" dns.getServers()")]),s._v(" "),a("p",[s._v("返回一个用于当前DNS解析的IP地址的数组的字符串，格式根据rfc5952。如果使用自定义端口，那么字符串将包括一个端口部分。")]),s._v(" "),a("h2",{attrs:{id:"dns-lookup-hostname-options-callback"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-lookup-hostname-options-callback","aria-hidden":"true"}},[s._v("#")]),s._v(" dns.lookup(hostname[, options], callback)")]),s._v(" "),a("h2",{attrs:{id:"dns-lookupservice-address-port-callback"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-lookupservice-address-port-callback","aria-hidden":"true"}},[s._v("#")]),s._v(" dns.lookupService(address, port, callback)")]),s._v(" "),a("h2",{attrs:{id:"dns-resolve-hostname-rrtype-callback"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-resolve-hostname-rrtype-callback","aria-hidden":"true"}},[s._v("#")]),s._v(" dns.resolve(hostname[, rrtype], callback)")]),s._v(" "),a("h2",{attrs:{id:"dns-resolve4-hostname-options-callback"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-resolve4-hostname-options-callback","aria-hidden":"true"}},[s._v("#")]),s._v(" dns.resolve4(hostname[, options], callback)")]),s._v(" "),a("h2",{attrs:{id:"dns-resolve6-hostname-options-callback"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-resolve6-hostname-options-callback","aria-hidden":"true"}},[s._v("#")]),s._v(" dns.resolve6(hostname[, options], callback)")]),s._v(" "),a("h2",{attrs:{id:"dns-resolveany-hostname-callback"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-resolveany-hostname-callback","aria-hidden":"true"}},[s._v("#")]),s._v(" dns.resolveAny(hostname, callback)")]),s._v(" "),a("h2",{attrs:{id:"dns-resolvecname-hostname-callback"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-resolvecname-hostname-callback","aria-hidden":"true"}},[s._v("#")]),s._v(" dns.resolveCname(hostname, callback)")]),s._v(" "),a("h2",{attrs:{id:"dns-resolvemx-hostname-callback"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-resolvemx-hostname-callback","aria-hidden":"true"}},[s._v("#")]),s._v(" dns.resolveMx(hostname, callback)")]),s._v(" "),a("h2",{attrs:{id:"dns-resolvenaptr-hostname-callback"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-resolvenaptr-hostname-callback","aria-hidden":"true"}},[s._v("#")]),s._v(" dns.resolveNaptr(hostname, callback)")]),s._v(" "),a("h2",{attrs:{id:"dns-resolvens-hostname-callback"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-resolvens-hostname-callback","aria-hidden":"true"}},[s._v("#")]),s._v(" dns.resolveNs(hostname, callback)")]),s._v(" "),a("h2",{attrs:{id:"dns-resolveptr-hostname-callback"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-resolveptr-hostname-callback","aria-hidden":"true"}},[s._v("#")]),s._v(" dns.resolvePtr(hostname, callback)")]),s._v(" "),a("h2",{attrs:{id:"dns-resolvesoa-hostname-callback"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-resolvesoa-hostname-callback","aria-hidden":"true"}},[s._v("#")]),s._v(" dns.resolveSoa(hostname, callback)")]),s._v(" "),a("h2",{attrs:{id:"dns-resolvesrv-hostname-callback"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-resolvesrv-hostname-callback","aria-hidden":"true"}},[s._v("#")]),s._v(" dns.resolveSrv(hostname, callback)")]),s._v(" "),a("h2",{attrs:{id:"dns-resolvetxt-hostname-callback"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-resolvetxt-hostname-callback","aria-hidden":"true"}},[s._v("#")]),s._v(" dns.resolveTxt(hostname, callback)")]),s._v(" "),a("h2",{attrs:{id:"dns-reverse-ip-callback"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-reverse-ip-callback","aria-hidden":"true"}},[s._v("#")]),s._v(" dns.reverse(ip, callback)")]),s._v(" "),a("h2",{attrs:{id:"dns-setservers-servers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-setservers-servers","aria-hidden":"true"}},[s._v("#")]),s._v(" dns.setServers(servers)")]),s._v(" "),a("h2",{attrs:{id:"错误码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#错误码","aria-hidden":"true"}},[s._v("#")]),s._v(" 错误码")]),s._v(" "),a("p",[s._v("每个DNS查询可以返回一个错误代码如下:")]),s._v(" "),a("ul",[a("li",[s._v("dns.NODATA: DNS服务返回没有数据.")]),s._v(" "),a("li",[s._v("dns.FORMERR: DNS服务器查询没有格式化.")]),s._v(" "),a("li",[s._v("dns.SERVFAIL: DNS服务器返回失败。")]),s._v(" "),a("li",[s._v("dns.NOTFOUND: 域名未找到。")]),s._v(" "),a("li",[s._v("dns.NOIMP: DNS服务器不执行请求的操作。")]),s._v(" "),a("li",[s._v("dns.REFUSED: 查询DNS服务器拒绝。")]),s._v(" "),a("li",[s._v("dns.BADQUERY: 未格式化DNS查询。")]),s._v(" "),a("li",[s._v("dns.BADNAME: 未格式化主机名")]),s._v(" "),a("li",[s._v("dns.BADFAMILY: 没有提供地址族")]),s._v(" "),a("li",[s._v("dns.BADRESP: 未格式化DNS回复")]),s._v(" "),a("li",[s._v("dns.CONNREFUSED: 无法连接DNS服务器")]),s._v(" "),a("li",[s._v("dns.TIMEOUT: 连接DNS服务器超时")]),s._v(" "),a("li",[s._v("dns.EOF: 文件末尾")]),s._v(" "),a("li",[s._v("dns.FILE: 读取文件错误")]),s._v(" "),a("li",[s._v("dns.NOMEM: 内存溢出")]),s._v(" "),a("li",[s._v("dns.DESTRUCTION: 通道以及销毁")]),s._v(" "),a("li",[s._v("dns.BADSTR: 未格式化字符串")]),s._v(" "),a("li",[s._v("dns.BADFLAGS: 指定非法标记")]),s._v(" "),a("li",[s._v("dns.NONAME: 给定的主机名不是数字。")]),s._v(" "),a("li",[s._v("dns.BADHINTS: 指定非法的提示标志。")]),s._v(" "),a("li",[s._v("dns.NOTINITIALIZED: c-ares异步DNS请求库初始化未完成。")]),s._v(" "),a("li",[s._v("dns.LOADIPHLPAPI: 加载iphlpapi.dll(Windows IP辅助API应用程序接口模块)错误")]),s._v(" "),a("li",[s._v("dns.ADDRGETNETWORKPARAMS: 找不到GetNetworkParams(读取本机DNS信息)函数")]),s._v(" "),a("li",[s._v("dns.CANCELLED: DNS查询取消")])])])}],!1,null,null,null);e.options.__file="README.md";t.default=e.exports}}]);