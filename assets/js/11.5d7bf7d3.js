(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{175:function(t,s,n){"use strict";n.r(s);var a=n(0),o=Object(a.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"content"},[n("h1",{attrs:{id:"module-模块"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#module-模块","aria-hidden":"true"}},[t._v("#")]),t._v(" module 模块")]),t._v(" "),n("p",[t._v("先来一个 index.js，因为 module 这个关键词是已经被声明过点，所以下面的代码运行会产生异常")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" module "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("require")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'module'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("这里运行 index.js")]),t._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("node index.js\nindex.js:1\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("function "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("exports, require, module, __filename, __dirname"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" const module "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" require"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'module'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                                                                    ^\n\nSyntaxError: Identifier "),n("span",{attrs:{class:"token string"}},[t._v("'module'")]),t._v(" has already been declared\n    at createScript "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm.js:80:10"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at Object.runInThisContext "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm.js:139:10"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at Module._compile "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module.js:616:28"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at Object.Module._extensions"),n("span",{attrs:{class:"token punctuation"}},[t._v("..")]),t._v("js "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module.js:663:10"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at Module.load "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module.js:565:32"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at tryModuleLoad "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module.js:505:12"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at Function.Module._load "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module.js:497:3"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at Function.Module.runMain "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module.js:693:10"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at startup "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bootstrap_node.js:191:16"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at bootstrap_node.js:612:3\n")])])]),n("p",[t._v("通过上面的异常发现")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("exports"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" require"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" module"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" __filename"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" __dirname"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("这里是一个知识点 [模块包装器](#wrapper 模块包装器)，你可以现在就去看看，或者继续阅读（在执行模块代码之前，Node.js 会使用一个如上的函数包装器将其包装）。")]),t._v(" "),n("p",[t._v("让我们修正 index.js, 然后再次运行")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" moduleObj "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("require")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'module'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("node index.js\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function: Module"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  builtinModules: \n   "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'async_hooks'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'assert'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'buffer'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'child_process'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'console'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'constants'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'crypto'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'cluster'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'dgram'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'dns'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'domain'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'events'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'fs'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'http'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'http2'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'_http_agent'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'_http_client'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'_http_common'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'_http_incoming'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'_http_outgoing'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'_http_server'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'https'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'inspector'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'module'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'net'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'os'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'path'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'perf_hooks'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'process'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'punycode'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'querystring'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'readline'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'repl'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'stream'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'_stream_readable'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'_stream_writable'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'_stream_duplex'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'_stream_transform'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'_stream_passthrough'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'_stream_wrap'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'string_decoder'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'sys'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'timers'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'tls'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'_tls_common'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'_tls_legacy'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'_tls_wrap'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'tty'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'url'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'util'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'v8'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'vm'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'zlib'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'v8/tools/splaytree'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'v8/tools/codemap'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'v8/tools/consarray'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'v8/tools/csvparser'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'v8/tools/profile'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'v8/tools/profile_view'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'v8/tools/logreader'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'v8/tools/tickprocessor'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'v8/tools/SourceMap'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'v8/tools/tickprocessor-driver'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'node-inspect/lib/_inspect'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'node-inspect/lib/internal/inspect_client'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'node-inspect/lib/internal/inspect_repl'")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\n  _cache: \n   "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'/Users/zhuxiaopeng/Desktop/github/nodejs.cn/index.js'")]),n("span",{attrs:{class:"token keyword"}},[t._v(":")]),t._v(" \n      Module "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        id: "),n("span",{attrs:{class:"token string"}},[t._v("'.'")]),t._v(",\n        exports: "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n        parent: null,\n        filename: "),n("span",{attrs:{class:"token string"}},[t._v("'/Users/zhuxiaopeng/Desktop/github/nodejs.cn/index.js'")]),t._v(",\n        loaded: false,\n        children: "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\n        paths: "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Array"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n  _pathCache: \n   "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'/Users/zhuxiaopeng/Desktop/github/nodejs.cn/index.js\\u0000'")]),n("span",{attrs:{class:"token keyword"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'/Users/zhuxiaopeng/Desktop/github/nodejs.cn/index.js'")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n  _extensions: "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'.js'")]),n("span",{attrs:{class:"token keyword"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", "),n("span",{attrs:{class:"token string"}},[t._v("'.json'")]),n("span",{attrs:{class:"token keyword"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", "),n("span",{attrs:{class:"token string"}},[t._v("'.node'")]),n("span",{attrs:{class:"token keyword"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n  globalPaths: \n   "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'/Users/zhuxiaopeng/.node_modules'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'/Users/zhuxiaopeng/.node_libraries'")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'/Users/zhuxiaopeng/.nvm/versions/node/v8.11.3/lib/node'")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\n  wrapper: \n   "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'(function (exports, require, module, __filename, __dirname) { '")]),t._v(",\n     "),n("span",{attrs:{class:"token string"}},[t._v("'\\n});'")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\n  wrap: "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\n  _debug: "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\n  _findPath: "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\n  _nodeModulePaths: "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\n  _resolveLookupPaths: "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\n  _load: "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\n  _resolveFilename: "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\n  runMain: "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\n  _initPaths: "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\n  _preloadModules: "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\n  Module: "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Circular"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("在这些输出的结果中，可以看到这些字段")]),t._v(" "),n("ul",[n("li",[t._v("builtinModules: nodejs 固有模块")]),t._v(" "),n("li",[t._v("_cache: 缓存的模块，在这里可以注意到，刚刚运行的 index.js 已经进入了缓存")]),t._v(" "),n("li",[t._v("_pathCache: 缓存的模块路径，同样是刚刚运行的 index.js")]),t._v(" "),n("li",[t._v("_extensions: 扩展 "),n("code",[t._v("{ '.js': [Function], '.json': [Function], '.node': [Function] }")])]),t._v(" "),n("li",[t._v("globalPaths: 模块的全局路径")]),t._v(" "),n("li",[t._v("wrapper: 模块包装器")]),t._v(" "),n("li",[t._v("_debug")]),t._v(" "),n("li",[t._v("_findPath")]),t._v(" "),n("li",[t._v("_nodeModulePaths")]),t._v(" "),n("li",[t._v("_resolveLookupPaths")]),t._v(" "),n("li",[t._v("_load")]),t._v(" "),n("li",[t._v("_resolveFilename")]),t._v(" "),n("li",[t._v("runMain")]),t._v(" "),n("li",[t._v("_initPaths")]),t._v(" "),n("li",[t._v("_preloadModules")]),t._v(" "),n("li",[t._v("Module")])]),t._v(" "),n("h2",{attrs:{id:"wrapper-模块包装器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#wrapper-模块包装器","aria-hidden":"true"}},[t._v("#")]),t._v(" wrapper 模块包装器")]),t._v(" "),n("p",[t._v("在执行模块代码之前，Node.js 会使用一个如下的函数包装器将其包装：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("function")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("exports"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" require"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" module"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" __filename"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" __dirname"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{attrs:{class:"token comment"}},[t._v("// 模块的代码实际上在这里")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("通过这样做，Node.js 实现了以下几点：")]),t._v(" "),n("p",[t._v("它保持了顶层的变量（用 "),n("code",[t._v("var")]),t._v("、"),n("code",[t._v("const")]),t._v(" 或 "),n("code",[t._v("let")]),t._v(" 定义）作用在模块范围内，而不是全局对象。\n它有助于提供一些看似全局的但实际上是模块特定的变量，例如：")]),t._v(" "),n("ul",[n("li",[t._v("实现者可以用于从模块中导出值的 "),n("code",[t._v("module")]),t._v(" 和 "),n("code",[t._v("exports")]),t._v(" 对象。")]),t._v(" "),n("li",[t._v("包含模块绝对文件名和目录路径的快捷变量 "),n("code",[t._v("__filename")]),t._v(" 和 "),n("code",[t._v("__dirname")]),t._v("。")])]),t._v(" "),n("h2",{attrs:{id:"exports"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#exports","aria-hidden":"true"}},[t._v("#")]),t._v(" exports")]),t._v(" "),n("p",[t._v("这是一个对于 "),n("strong",[t._v("module.exports")]),t._v(" 的更简短的引用形式。什么时候使用 "),n("code",[t._v("exports")]),t._v("、什么时候使用 "),n("code",[t._v("module.exports")]),t._v("？")]),t._v(" "),n("h3",{attrs:{id:"exports-shortcut-快捷方式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#exports-shortcut-快捷方式","aria-hidden":"true"}},[t._v("#")]),t._v(" exports shortcut 快捷方式")]),t._v(" "),n("p",[n("code",[t._v("exports")]),t._v(" 变量是在模块的文件级别作用域内有效的，它在模块被执行前被赋予 "),n("code",[t._v("module.exports")]),t._v(" 的值。")]),t._v(" "),n("p",[t._v("它有一个快捷方式，以便 "),n("code",[t._v("module.exports.f = ...")]),t._v(" 可以被更简洁地写成 "),n("code",[t._v("exports.f = ...")]),t._v("。 注意，就像任何变量，如果一个新的值被赋值给 "),n("code",[t._v("exports")]),t._v("，它就不再绑定到 "),n("code",[t._v("module.exports")]),t._v("：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("module"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hello "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token boolean"}},[t._v("true")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("// 从对模块的引用中导出")]),t._v("\nexports "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" hello"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token boolean"}},[t._v("false")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),n("span",{attrs:{class:"token comment"}},[t._v("// 不导出，只在模块内有效")]),t._v("\n")])])]),n("p",[t._v("当 "),n("code",[t._v("module.exports")]),t._v(" 属性被一个新的对象完全替代时，也会重新赋值 "),n("code",[t._v("exports")]),t._v("，例如：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("module"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("Constructor")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{attrs:{class:"token comment"}},[t._v("// ... 及其他")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("为了解释这个行为，想象对 "),n("code",[t._v("require()")]),t._v(" 的假设实现，它跟 "),n("code",[t._v("require()")]),t._v(" 的实际实现相当类似：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("require")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token comment"}},[t._v("/* ... */")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" module "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" exports"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" exports"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// 模块代码在这。在这个例子中，定义了一个函数。")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("someFunc")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    exports "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" someFunc"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// 此时，exports 不再是一个 module.exports 的快捷方式，")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// 且这个模块依然导出一个空的默认对象。")]),t._v("\n    module"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" someFunc"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// 此时，该模块导出 someFunc，而不是默认对象。")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" module"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" module"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h2",{attrs:{id:"require"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#require","aria-hidden":"true"}},[t._v("#")]),t._v(" require")]),t._v(" "),n("p",[t._v("引入模块")]),t._v(" "),n("p",[t._v("module.require(id) 返回已解析的模块的 module.exports\nodule.require 方法提供了一种类似 require() 从原始模块被调用的加载模块的方式。\n注意，为了做到这个，需要获得一个 module 对象的引用。 因为 require() 会返回 module.exports，且 module 只在一个特定的模块代码中有效，所以为了使用它，必须明确地导出。")]),t._v(" "),n("p",[t._v("require.cache 被引入的模块将被缓存在这个对象中。从此对象中删除键值对将会导致下一次 require 重新加载被删除的模块。注意不能删除 native addons（原生插件），因为它们的重载将会导致错误。\nrequire.main Module对象，表示Node.js进程启动时加载的条目脚本。")]),t._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("Module "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  id: "),n("span",{attrs:{class:"token string"}},[t._v("'.'")]),t._v(",\n  exports: "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n  parent: null,\n  filename: "),n("span",{attrs:{class:"token string"}},[t._v("'/absolute/path/to/entry.js'")]),t._v(",\n  loaded: false,\n  children: "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\n  paths:\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'/absolute/path/to/node_modules'")]),t._v(",\n    "),n("span",{attrs:{class:"token string"}},[t._v("'/absolute/path/node_modules'")]),t._v(",\n    "),n("span",{attrs:{class:"token string"}},[t._v("'/absolute/node_modules'")]),t._v(",\n    "),n("span",{attrs:{class:"token string"}},[t._v("'/node_modules'")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("require.resolve(request[, options]) 使用内部的 require() 机制查询模块的位置, 此操作只返回解析后的文件名，不会加载该模块。")]),t._v(" "),n("ul",[n("li",[t._v("request 需要解析的模块路径。")]),t._v(" "),n("li",[t._v("options 解析模块的起点路径。此参数存在时，将使用这些路径而非默认解析路径。    注意此数组中的每一个路径都被用作模块解析算法的起点，意味着 node_modules 层级将从这里开始查询。")])]),t._v(" "),n("p",[t._v("require.resolve.paths(request) 返回一个数组，其中包含解析 request 过程中被查询的路径。 如果 request 字符串指向核心模块（例如 http 或 fs），则返回 null。")]),t._v(" "),n("h2",{attrs:{id:"module"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#module","aria-hidden":"true"}},[t._v("#")]),t._v(" module")]),t._v(" "),n("p",[t._v("对当前模块的引用, 查看关于 module object 的章节。 module.exports 用于指定一个模块所导出的内容，即可以通过 require() 访问的内容。")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("Module "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  id: "),n("span",{attrs:{class:"token string"}},[t._v("'.'")]),t._v(", \n  exports: "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n  parent: null,\n  filename: "),n("span",{attrs:{class:"token string"}},[t._v("'/Users/zhuxiaopeng/Desktop/github/nodejs.cn/index.js'")]),t._v(",\n  loaded: false,\n  children: "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\n  paths: "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Array"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("module.id 模块的标识符。 通常是完全解析后的文件名\nmodule.exports 对象是由模块系统创建的\nmodule.parent 最先引用该模块的模块\nmodule.filename 模块的完全解析后的文件名\nmodule.loaded 模块是否已经加载完成，或正在加载中\nmodule.children 被该模块引用的模块对象\nmodule.paths 模块的搜索路径。")]),t._v(" "),n("h2",{attrs:{id:"dirname"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dirname","aria-hidden":"true"}},[t._v("#")]),t._v(" __dirname")]),t._v(" "),n("p",[t._v("当前模块的目录名，等同于 "),n("code",[t._v("__filename")]),t._v(" 的 "),n("code",[t._v("path.dirname()")]),t._v(" 的值。")]),t._v(" "),n("h2",{attrs:{id:"filename"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#filename","aria-hidden":"true"}},[t._v("#")]),t._v(" __filename")]),t._v(" "),n("p",[t._v("当前模块的文件名称---解析后的绝对路径。")]),t._v(" "),n("h2",{attrs:{id:"require-import-傻傻分不清楚-todo"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#require-import-傻傻分不清楚-todo","aria-hidden":"true"}},[t._v("#")]),t._v(" require import 傻傻分不清楚 todo")]),t._v(" "),n("p",[t._v("node 中可以开心的使用 import 方式吗")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" moudleObj "),n("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'module'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("node -v \nv8.11.3\nnode index.js\n/Users/zhuxiaopeng/Desktop/github/nodejs.cn/index.js:2\n"),n("span",{attrs:{class:"token function"}},[t._v("import")]),t._v(" module from "),n("span",{attrs:{class:"token string"}},[t._v("'module'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n^^^^^^\n\nSyntaxError: Unexpected token "),n("span",{attrs:{class:"token function"}},[t._v("import")]),t._v("\n    at createScript "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm.js:80:10"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at Object.runInThisContext "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm.js:139:10"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at Module._compile "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module.js:616:28"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at Object.Module._extensions"),n("span",{attrs:{class:"token punctuation"}},[t._v("..")]),t._v("js "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module.js:663:10"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at Module.load "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module.js:565:32"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at tryModuleLoad "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module.js:505:12"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at Function.Module._load "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module.js:497:3"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at Function.Module.runMain "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module.js:693:10"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at startup "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bootstrap_node.js:191:16"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at bootstrap_node.js:612:3\n\nnode -v \nv10.11.0\nnode index.js\n/Users/zhuxiaopeng/Desktop/github/nodejs.cn/index.js:2\n"),n("span",{attrs:{class:"token function"}},[t._v("import")]),t._v(" module from "),n("span",{attrs:{class:"token string"}},[t._v("'module'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n^^^^^^\n\nSyntaxError: Unexpected token "),n("span",{attrs:{class:"token function"}},[t._v("import")]),t._v("\n    at createScript "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm.js:80:10"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at Object.runInThisContext "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm.js:139:10"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at Module._compile "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module.js:616:28"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at Object.Module._extensions"),n("span",{attrs:{class:"token punctuation"}},[t._v("..")]),t._v("js "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module.js:663:10"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at Module.load "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module.js:565:32"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at tryModuleLoad "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module.js:505:12"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at Function.Module._load "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module.js:497:3"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at Function.Module.runMain "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module.js:693:10"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at startup "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bootstrap_node.js:191:16"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at bootstrap_node.js:612:3\n")])])])])}],!1,null,null,null);o.options.__file="README.md";s.default=o.exports}}]);